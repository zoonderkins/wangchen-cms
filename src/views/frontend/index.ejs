<%- contentFor('body') %>

    <% if (banners && banners.length> 0) { %>
        <!-- Banner Carousel -->
        <div class="relative w-full overflow-hidden bg-gray-100 mb-8" style="height: 400px;">
            <!-- Banner Container -->
            <div id="banner-carousel" class="relative w-full h-full">
                <% banners.forEach((banner, index)=> { %>
                    <div class="banner-slide absolute inset-0 w-full h-full"
                        style="display: <%= index === 0 ? 'block' : 'none' %>;" data-index="<%= index %>">
                        <% if (banner.mediaType==='image' ) { %>
                            <% if (banner.url) { %>
                                <a href="<%= banner.url %>" target="_blank" rel="noopener noreferrer"
                                    class="block w-full h-full">
                                    <picture>
                                        <% if (banner.mediaPathMobile) { %>
                                        <source media="(max-width: 640px)" srcset="<%= banner.mediaPathMobile %>">
                                        <% } %>
                                        <% if (banner.mediaPathTablet) { %>
                                        <source media="(max-width: 1024px)" srcset="<%= banner.mediaPathTablet %>">
                                        <% } %>
                                        <% if (banner.mediaPathDesktop) { %>
                                        <source media="(min-width: 1025px)" srcset="<%= banner.mediaPathDesktop %>">
                                        <% } %>
                                        <img src="<%= banner.mediaPath %>" alt="<%= banner.title %>"
                                            class="w-full h-full object-cover">
                                    </picture>
                                </a>
                                <% } else { %>
                                    <picture>
                                        <% if (banner.mediaPathMobile) { %>
                                        <source media="(max-width: 640px)" srcset="<%= banner.mediaPathMobile %>">
                                        <% } %>
                                        <% if (banner.mediaPathTablet) { %>
                                        <source media="(max-width: 1024px)" srcset="<%= banner.mediaPathTablet %>">
                                        <% } %>
                                        <% if (banner.mediaPathDesktop) { %>
                                        <source media="(min-width: 1025px)" srcset="<%= banner.mediaPathDesktop %>">
                                        <% } %>
                                        <img src="<%= banner.mediaPath %>" alt="<%= banner.title %>"
                                            class="w-full h-full object-cover">
                                    </picture>
                                    <% } %>
                                        <% } else if (banner.mediaType==='video' ) { %>
                                            <video id="video-<%= index %>" autoplay muted loop playsinline
                                                class="w-full h-full object-cover">
                                                <source src="<%= banner.mediaPath %>" type="video/mp4">
                                                Your browser does not support the video tag.
                                            </video>
                                            <% } %>
                                                <div
                                                    class="absolute bottom-0 left-0 right-0 bg-black bg-opacity-50 text-white p-4">
                                                    <h2 class="text-xl font-bold">
                                                        <%= banner.title %>
                                                    </h2>
                                                    <% if (banner.description) { %>
                                                        <p class="mt-2">
                                                            <%= banner.description %>
                                                        </p>
                                                        <% } %>
                                                            <% if (banner.url && banner.mediaType !=='image' ) { %>
                                                                <a href="<%= banner.url %>" target="_blank"
                                                                    rel="noopener noreferrer"
                                                                    class="inline-block mt-2 px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700">Learn
                                                                    More</a>
                                                                <% } %>
                                                </div>
                    </div>
                    <% }); %>

                        <% if (banners.length> 1) { %>
                            <!-- Navigation Arrows -->
                            <a href="#" id="prev-banner"
                                class="absolute left-4 top-1/2 transform -translate-y-1/2 bg-black bg-opacity-70 text-white p-3 rounded-full z-20 hover:bg-opacity-90 focus:outline-none cursor-pointer"
                                style="width: 40px; height: 40px; display: flex; align-items: center; justify-content: center;">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24"
                                    stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                        d="M15 19l-7-7 7-7" />
                                </svg>
                            </a>
                            <a href="#" id="next-banner"
                                class="absolute right-4 top-1/2 transform -translate-y-1/2 bg-black bg-opacity-70 text-white p-3 rounded-full z-20 hover:bg-opacity-90 focus:outline-none cursor-pointer"
                                style="width: 40px; height: 40px; display: flex; align-items: center; justify-content: center;">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24"
                                    stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                        d="M9 5l7 7-7 7" />
                                </svg>
                            </a>

                            <!-- Indicators -->
                            <div class="absolute bottom-20 left-0 right-0 flex justify-center space-x-3 z-20">
                                <% banners.forEach((_, index)=> { %>
                                    <a href="#"
                                        class="banner-indicator h-4 w-4 rounded-full <%= index === 0 ? 'bg-white' : 'bg-gray-400' %> hover:bg-white focus:outline-none cursor-pointer"
                                        data-index="<%= index %>"></a>
                                    <% }); %>
                            </div>
                            <% } %>
            </div>
        </div>

        <!-- Banner Carousel Script -->
        <script>
            // Wait for the DOM to be fully loaded
            document.addEventListener('DOMContentLoaded', function () {
                // Get all the elements we need
                var slides = document.querySelectorAll('.banner-slide');
                var prevButton = document.getElementById('prev-banner');
                var nextButton = document.getElementById('next-banner');
                var indicators = document.querySelectorAll('.banner-indicator');

                // Only proceed if we have multiple slides
                if (slides.length <= 1) return;

                console.log('Carousel initialized with', slides.length, 'slides');

                var currentIndex = 0;
                var interval;

                // Function to show a specific slide
                function showSlide(index) {
                    console.log('Showing slide', index);

                    // Hide all slides
                    for (var i = 0; i < slides.length; i++) {
                        slides[i].style.display = 'none';
                    }

                    // Show the selected slide
                    slides[index].style.display = 'block';

                    // Update indicators
                    for (var j = 0; j < indicators.length; j++) {
                        indicators[j].classList.remove('bg-white');
                        indicators[j].classList.add('bg-gray-400');
                    }

                    indicators[index].classList.remove('bg-gray-400');
                    indicators[index].classList.add('bg-white');

                    // Pause all videos
                    var videos = document.querySelectorAll('.banner-slide video');
                    for (var k = 0; k < videos.length; k++) {
                        videos[k].pause();
                    }

                    // Play video if current slide has one
                    var currentVideo = slides[index].querySelector('video');
                    if (currentVideo) {
                        currentVideo.play();
                    }

                    currentIndex = index;
                }

                // Function to show the previous slide
                function showPrevSlide() {
                    clearInterval(interval);
                    var prevIndex = (currentIndex - 1 + slides.length) % slides.length;
                    showSlide(prevIndex);
                    startAutoRotation();
                }

                // Function to show the next slide
                function showNextSlide() {
                    clearInterval(interval);
                    var nextIndex = (currentIndex + 1) % slides.length;
                    showSlide(nextIndex);
                    startAutoRotation();
                }

                // Function to start automatic rotation
                function startAutoRotation() {
                    interval = setInterval(function () {
                        var nextIndex = (currentIndex + 1) % slides.length;
                        showSlide(nextIndex);
                    }, 6000);
                }

                // Add event listeners to the previous and next buttons
                if (prevButton) {
                    prevButton.addEventListener('click', function (e) {
                        e.preventDefault();
                        console.log('Previous button clicked');
                        showPrevSlide();
                        return false;
                    });
                }

                if (nextButton) {
                    nextButton.addEventListener('click', function (e) {
                        e.preventDefault();
                        console.log('Next button clicked');
                        showNextSlide();
                        return false;
                    });
                }

                // Add event listeners to the indicators
                for (var l = 0; l < indicators.length; l++) {
                    (function (index) {
                        indicators[index].addEventListener('click', function (e) {
                            e.preventDefault();
                            console.log('Indicator', index, 'clicked');
                            clearInterval(interval);
                            showSlide(index);
                            startAutoRotation();
                            return false;
                        });
                    })(l);
                }

                // Start automatic rotation
                startAutoRotation();
            });
        </script>
        <% } %>
<!-- Frontpage Picture Items Section -->
<% if (pictureItems && pictureItems.length> 0) { %>
    <div class="py-12">
        <div class="container mx-auto px-4">
            <% pictureItems.forEach(function(item) { %>
                <div class="mb-16">
                    <h2 class="text-2xl font-bold mb-8 text-center">
                        <%= currentLanguage==='en' ? item.title_en : item.title_tw %>
                    </h2>

                    <% if (item.images && item.images.length> 0) { %>
                        <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-4">
                            <% item.images.forEach(function(image) { %>
                                <div class="overflow-hidden rounded-lg shadow-md hover:shadow-lg transition-shadow">
                                    <% if (image.url) { %>
                                        <a href="<%= image.url %>" target="_blank" rel="noopener noreferrer">
                                            <img src="<%= image.path %>"
                                                alt="<%= image.alt || (currentLanguage === 'en' ? item.title_en : item.title_tw) %>"
                                                class="w-full h-48 object-cover">
                                        </a>
                                        <% } else { %>
                                            <img src="<%= image.path %>"
                                                alt="<%= image.alt || (currentLanguage === 'en' ? item.title_en : item.title_tw) %>"
                                                class="w-full h-48 object-cover">
                                            <% } %>
                                </div>
                                <% }); %>
                        </div>
                        <% } %>
                </div>
                <% }); %>
        </div>
    </div>
    <% } %>
            <!-- Latest News Section  首頁讀取最新消息 6筆-->
            <% if (latestNews && latestNews.length> 0) { %>
                <div class="bg-gray-50 py-12">
                    <div class="container mx-auto px-4">
                        <h2 class="text-2xl font-bold mb-6 text-center">
                            <%= currentLanguage==='en' ? 'Latest News' : '最新消息' %>
                        </h2>

                        <!-- News Items -->
                        <div class="space-y-6">
                            <% latestNews.forEach(function(item) { %>
                                <div class="bg-white p-4 rounded-lg shadow-md">
                                    <div class="flex flex-col md:flex-row gap-4">
                                        <% if (item.imageUrl) { %>
                                            <div class="md:w-1/4">
                                                <img src="<%= item.imageUrl %>" alt="<%= item.title %>"
                                                    class="w-full h-auto object-cover rounded">
                                            </div>
                                            <% } %>
                                                <div class="<%= item.imageUrl ? 'md:w-3/4' : 'w-full' %>">
                                                    <h2 class="text-xl font-semibold mb-2">
                                                        <%= item.title %>
                                                    </h2>
                                                    <div class="flex flex-wrap gap-2 mb-3">
                                                        <span class="text-gray-500 text-sm">
                                                            <%= new
                                                                Date(item.publishedDate).toLocaleDateString(currentLanguage==='tw'
                                                                ? 'zh-TW' : 'en-US' ) %>
                                                        </span>
                                                        <% if (item.category) { %>
                                                            <span
                                                                class="bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded">
                                                                <%= item.category.name %>
                                                            </span>
                                                            <% } %>
                                                    </div>
                                                    <% if (item.url) { %>
                                                        <a href="<%= item.url %>" target="_blank"
                                                            class="text-blue-600 hover:underline">
                                                            <%= currentLanguage==='tw' ? '閱讀更多' : 'Read More' %> →
                                                        </a>
                                                        <% } %>
                                                </div>
                                    </div>
                                </div>
                                <% }); %>
                        </div>
                    </div>
                </div>
                <% } %>

                    <!-- Frontpage Plain Text Items Section -->
                    <% if (plainTextItems && plainTextItems.length> 0) { %>
                        <div class="bg-gray-50 py-12">
                            <div class="container mx-auto px-4">
                                <div class="grid grid-cols-1 gap-8">
                                    <% plainTextItems.forEach(function(item) { %>
                                        <div
                                            class="bg-white rounded-lg shadow-md overflow-hidden hover:shadow-lg transition-shadow">
                                            <div class="p-6">
                                                <h3 class="text-xl font-semibold mb-4">
                                                    <%= currentLanguage==='en' ? item.title_en : item.title_tw %>
                                                </h3>
                                                <div class="text-gray-600 whitespace-pre-line">
                                                    <%- currentLanguage==='en' ? item.content_en : item.content_tw %>
                                                </div>
                                            </div>
                                        </div>
                                        <% }); %>
                                </div>
                            </div>
                        </div>
                        <% } %>

                            <!-- Frontpage Picture Items Section -->
                            <% if (pictureItems && pictureItems.length> 0) { %>
                                <div class="py-12">
                                    <div class="container mx-auto px-4">
                                        <% pictureItems.forEach(function(item) { %>
                                            <div class="mb-16">
                                                <h2 class="text-2xl font-bold mb-8 text-center">
                                                    <%= currentLanguage==='en' ? item.title_en : item.title_tw %>
                                                </h2>

                                                <% if (item.images && item.images.length> 0) { %>
                                                    <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-4">
                                                        <% item.images.forEach(function(image) { %>
                                                            <div
                                                                class="overflow-hidden rounded-lg shadow-md hover:shadow-lg transition-shadow">
                                                                <img src="<%= image.path %>"
                                                                    alt="<%= currentLanguage=== 'en' ? item.title_en : item.title_tw %>"
                                                                    class="w-full h-48 object-cover">
                                                            </div>
                                                            <% }); %>
                                                    </div>
                                                    <% } %>
                                            </div>
                                            <% }); %>
                                    </div>
                                </div>
                                <% } %>

                                    <!-- Related Links Section -->
                                    <% if (links && links.length> 0) { %>
                                        <div class="container mx-auto px-4 py-8 mb-12">
                                            <div class="max-w-6xl mx-auto">
                                                <h2 class="text-2xl font-bold mb-6 text-center">
                                                    <%= currentLanguage==='en' ? 'Related Links' : '相關連結' %>
                                                </h2>

                                                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                                                    <% links.forEach(function(link) { %>
                                                        <a href="<%= link.url %>" target="_blank"
                                                            rel="noopener noreferrer" class="block group">
                                                            <div
                                                                class="bg-white rounded-lg shadow-md overflow-hidden transition-transform duration-300 transform hover:-translate-y-1 hover:shadow-lg">
                                                                <% if (link.image) { %>
                                                                    <div class="h-40 overflow-hidden">
                                                                        <img src="<%= link.image %>"
                                                                            alt="<%= currentLanguage==='en' ? link.title_en : link.title_tw %>"
                                                                            class="w-full h-full object-cover transition-transform duration-500 transform group-hover:scale-105">
                                                                    </div>
                                                                    <% } else { %>
                                                                        <div
                                                                            class="h-40 bg-gray-200 flex items-center justify-center">
                                                                            <svg xmlns="http://www.w3.org/2000/svg"
                                                                                class="h-12 w-12 text-gray-400"
                                                                                fill="none" viewBox="0 0 24 24"
                                                                                stroke="currentColor">
                                                                                <path stroke-linecap="round"
                                                                                    stroke-linejoin="round"
                                                                                    stroke-width="2"
                                                                                    d="M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1">
                                                                                </path>
                                                                            </svg>
                                                                        </div>
                                                                        <% } %>
                                                                            <div class="p-4">
                                                                                <h3
                                                                                    class="text-lg font-semibold text-gray-800 mb-2 group-hover:text-blue-600">
                                                                                    <%= currentLanguage==='en' ?
                                                                                        link.title_en : link.title_tw %>
                                                                                </h3>
                                                                                <div
                                                                                    class="flex items-center text-gray-600 text-sm">
                                                                                    <svg xmlns="http://www.w3.org/2000/svg"
                                                                                        class="h-4 w-4 mr-1" fill="none"
                                                                                        viewBox="0 0 24 24"
                                                                                        stroke="currentColor">
                                                                                        <path stroke-linecap="round"
                                                                                            stroke-linejoin="round"
                                                                                            stroke-width="2"
                                                                                            d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14">
                                                                                        </path>
                                                                                    </svg>
                                                                                    <%= currentLanguage==='en'
                                                                                        ? 'Visit Link' : '訪問連結' %>
                                                                                </div>
                                                                            </div>
                                                            </div>
                                                        </a>
                                                        <% }); %>
                                                </div>
                                            </div>
                                        </div>
                                        <% } %>